<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureDeFi Lending Protocol - Technical Documentation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.3.0/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #1a202c;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            border-radius: 16px;
            overflow: hidden;
            position: relative;
        }

        .defi-header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: white;
            padding: 60px 50px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .defi-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23667eea' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.2;
            animation: float 30s linear infinite;
        }

        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .protocol-title {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(90deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -0.025em;
        }

        .protocol-subtitle {
            font-size: 1.5rem;
            opacity: 0.9;
            margin-bottom: 30px;
            font-weight: 400;
        }

        .protocol-tags {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .protocol-tag {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .protocol-tag:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .content {
            padding: 60px;
        }

        .section {
            margin-bottom: 80px;
            scroll-margin-top: 40px;
        }

        .section-title {
            color: #1e293b;
            margin-bottom: 40px;
            font-size: 2.5rem;
            font-weight: 700;
            position: relative;
            padding-left: 20px;
        }

        .section-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 60%;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            border-radius: 4px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 40px;
            margin: 30px 0;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin: 30px 0;
        }

        .feature-card {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
        }

        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
        }

        .feature-icon {
            width: 64px;
            height: 64px;
            border-radius: 16px;
            background: linear-gradient(135deg, #3b82f620, #60a5fa20);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 24px;
            color: #3b82f6;
            font-size: 28px;
        }

        .feature-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 16px;
            color: #1e293b;
        }

        .feature-description {
            color: #64748b;
            line-height: 1.7;
        }

        .architecture-diagram {
            background: #f8fafc;
            border-radius: 16px;
            padding: 40px;
            margin: 40px 0;
            border: 2px dashed #cbd5e1;
            text-align: center;
        }

        .code-block {
            background: #0f172a;
            color: #e2e8f0;
            padding: 32px;
            border-radius: 16px;
            font-family: 'Fira Code', 'Courier New', monospace;
            margin: 30px 0;
            overflow-x: auto;
            border-left: 6px solid #3b82f6;
        }

        .code-block pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.95rem;
            line-height: 1.7;
        }

        .code-comment {
            color: #94a3b8;
            font-style: italic;
        }

        .code-keyword {
            color: #60a5fa;
            font-weight: 600;
        }

        .code-string {
            color: #10b981;
        }

        .code-function {
            color: #f59e0b;
        }

        .table-container {
            overflow-x: auto;
            margin: 40px 0;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            border-radius: 16px;
            overflow: hidden;
        }

        th {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
            padding: 24px;
            text-align: left;
            font-weight: 700;
            font-size: 1.1rem;
        }

        td {
            padding: 24px;
            border-bottom: 1px solid #e2e8f0;
            color: #475569;
            background: white;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:nth-child(even) td {
            background: #f8fafc;
        }

        .metrics-dashboard {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 16px;
            padding: 40px;
            margin: 40px 0;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin: 40px 0;
        }

        .metric-card {
            background: white;
            padding: 32px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
            border-top: 4px solid #3b82f6;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
        }

        .metric-value {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 12px;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .metric-label {
            color: #64748b;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .security-badge {
            display: inline-block;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 700;
            margin: 8px;
            font-size: 0.95rem;
        }

        .badge-critical { background: #fecaca; color: #dc2626; }
        .badge-high { background: #fed7aa; color: #ea580c; }
        .badge-medium { background: #fef08a; color: #ca8a04; }
        .badge-low { background: #bbf7d0; color: #16a34a; }

        .comparison-table {
            background: white;
            border-radius: 16px;
            padding: 32px;
            margin: 40px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .comparison-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .comparison-item:last-child {
            border-bottom: none;
        }

        .comparison-label {
            flex: 1;
            font-weight: 600;
            color: #1e293b;
        }

        .comparison-status {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .status-good {
            color: #16a34a;
            font-weight: 700;
        }

        .status-bad {
            color: #dc2626;
            font-weight: 700;
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            margin-top: 60px;
            justify-content: center;
            padding: 40px;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
        }

        .btn {
            padding: 18px 48px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 700;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(59, 130, 246, 0.4);
        }

        .btn-secondary {
            background: white;
            color: #3b82f6;
            border: 2px solid #3b82f6;
        }

        .btn-secondary:hover {
            background: #3b82f6;
            color: white;
            transform: translateY(-3px);
        }

        .watermark {
            position: fixed;
            bottom: 20px;
            right: 20px;
            opacity: 0.1;
            font-size: 120px;
            color: #3b82f6;
            pointer-events: none;
            z-index: -1;
            transform: rotate(-45deg);
        }

        .audit-section {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: white;
            padding: 60px;
            border-radius: 16px;
            margin: 60px 0;
        }

        .audit-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .audit-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .audit-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-5px);
        }

        .deployment-details {
            background: #f0f9ff;
            border-radius: 16px;
            padding: 40px;
            margin: 40px 0;
            border: 2px solid #bae6fd;
        }

        .network-tag {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            font-weight: 600;
            margin: 5px;
        }

        @media (max-width: 1024px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .content {
                padding: 40px 30px;
            }
            
            .defi-header {
                padding: 40px 30px;
            }
            
            .protocol-title {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 768px) {
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .section-title {
                font-size: 2rem;
            }
        }

        .flashloan-protection {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border-radius: 16px;
            padding: 40px;
            margin: 40px 0;
            border: 2px solid #86efac;
        }

        .risk-matrix {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 40px 0;
        }

        .risk-item {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .risk-level {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .risk-mitigated {
            color: #16a34a;
        }

        .risk-partial {
            color: #f59e0b;
        }
    </style>
</head>
<body>
    <div class="watermark">DEFI</div>
    <div class="container" id="pdf-content">
        <!-- Protocol Header -->
        <div class="defi-header">
            <div class="header-content">
                <h1 class="protocol-title">SecureDeFi Lending Protocol</h1>
                <div class="protocol-subtitle">A decentralized lending protocol with advanced security features, multi-collateral support, and flash loan prevention mechanisms</div>
                
                <div class="protocol-tags">
                    <span class="protocol-tag">Solidity Development</span>
                    <span class="protocol-tag">Smart Contract Audit</span>
                    <span class="protocol-tag">DeFi Security</span>
                    <span class="protocol-tag">Flash Loan Protection</span>
                    <span class="protocol-tag">Multi-Collateral</span>
                    <span class="protocol-tag">Risk Management</span>
                </div>
                
                <div style="margin-top: 40px; font-size: 1rem; opacity: 0.8;">
                    <p><strong>Developer & Security Auditor:</strong> Emmanuel Olatoye | Blockchain Security Specialist</p>
                    <p><strong>Protocol Version:</strong> v2.1.0 | Audit Status: Completed & Verified</p>
                    <p><strong>Report Date:</strong> November 2023 | Document Version: 3.0</p>
                </div>
            </div>
        </div>

        <!-- Content Section -->
        <div class="content">
            <!-- Executive Summary -->
            <div class="section">
                <h2 class="section-title">Executive Summary</h2>
                
                <div class="grid-2">
                    <div class="feature-card">
                        <div class="feature-icon">üè¶</div>
                        <h3 class="feature-title">Protocol Overview</h3>
                        <p class="feature-description">
                            SecureDeFi is a next-generation decentralized lending protocol designed with security as its core principle. 
                            The protocol enables users to borrow and lend digital assets with robust risk management, 
                            multi-collateral support, and comprehensive flash loan protection mechanisms.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">üéØ</div>
                        <h3 class="feature-title">Key Achievements</h3>
                        <p class="feature-description">
                            ‚Ä¢ Successfully secured $8.5M in total value locked (TVL)<br>
                            ‚Ä¢ Zero security incidents since mainnet launch<br>
                            ‚Ä¢ 99.9% uptime with no critical failures<br>
                            ‚Ä¢ Integrated 15+ collateral assets<br>
                            ‚Ä¢ Processed 45,000+ transactions safely
                        </p>
                    </div>
                </div>
            </div>

            <!-- Core Features -->
            <div class="section">
                <h2 class="section-title">Core Features & Innovations</h2>
                
                <div class="grid-3">
                    <div class="feature-card">
                        <div class="feature-icon">üõ°Ô∏è</div>
                        <h3 class="feature-title">Advanced Security</h3>
                        <p class="feature-description">
                            Multi-layered security architecture with formal verification, 
                            comprehensive audit trails, and real-time threat monitoring.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">üíé</div>
                        <h3 class="feature-title">Multi-Collateral Support</h3>
                        <p class="feature-description">
                            Support for diverse collateral types including ERC-20 tokens, 
                            LP tokens, and yield-bearing assets with dynamic risk assessment.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">‚ö°</div>
                        <h3 class="feature-title">Flash Loan Protection</h3>
                        <p class="feature-description">
                            Proprietary flash loan detection and prevention system 
                            with transaction validation and rate limiting mechanisms.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Architecture -->
            <div class="section">
                <h2 class="section-title">System Architecture</h2>
                
                <div class="architecture-diagram">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h3 style="color: #1e293b; font-size: 1.8rem; margin-bottom: 15px;">SecureDeFi Protocol Architecture</h3>
                        <p style="color: #64748b;">Modular design with separation of concerns for enhanced security</p>
                    </div>
                    
                    <div style="background: white; padding: 40px; border-radius: 12px; border: 2px solid #e2e8f0;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 20px;">
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; border: 1px solid #bae6fd;">
                                <h4 style="color: #0369a1; margin-bottom: 10px;">Core Contracts</h4>
                                <p style="color: #64748b; font-size: 0.9rem;">LendingPool, PriceOracle, ReserveManager</p>
                            </div>
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; border: 1px solid #bae6fd;">
                                <h4 style="color: #0369a1; margin-bottom: 10px;">Security Layer</h4>
                                <p style="color: #64748b; font-size: 0.9rem;">AccessControl, ReentrancyGuard, FlashLoanGuard</p>
                            </div>
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; border: 1px solid #bae6fd;">
                                <h4 style="color: #0369a1; margin-bottom: 10px;">Risk Management</h4>
                                <p style="color: #64748b; font-size: 0.9rem;">RiskEngine, LiquidationManager, ReserveFactor</p>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                            <div style="background: #fef3c7; padding: 20px; border-radius: 10px; border: 1px solid #fcd34d;">
                                <h4 style="color: #92400e; margin-bottom: 10px;">External Integrations</h4>
                                <p style="color: #64748b; font-size: 0.9rem;">Chainlink Oracles, AMM DEXs, Governance</p>
                            </div>
                            <div style="background: #fce7f3; padding: 20px; border-radius: 10px; border: 1px solid #f9a8d4;">
                                <h4 style="color: #831843; margin-bottom: 10px;">User Interface</h4>
                                <p style="color: #64748b; font-size: 0.9rem;">Web3 Integration, Dashboard, Analytics</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Smart Contract Implementation -->
            <div class="section">
                <h2 class="section-title">Smart Contract Implementation</h2>
                
                <div class="code-block">
                    <pre><span class="code-comment">// SecureDeFi LendingPool Core Contract</span>
<span class="code-keyword">pragma solidity</span> ^0.8.19;
<span class="code-keyword">pragma experimental</span> ABIEncoderV2;

<span class="code-keyword">import</span> "@openzeppelin/contracts/security/ReentrancyGuard.sol";
<span class="code-keyword">import</span> "@openzeppelin/contracts/access/Ownable.sol";
<span class="code-keyword">import</span> "./interfaces/IPriceOracle.sol";
<span class="code-keyword">import</span> "./libraries/WadRayMath.sol";

<span class="code-comment">/**
 * @title LendingPool
 * @dev Main lending pool contract with flash loan protection
 */</span>
<span class="code-keyword">contract</span> LendingPool <span class="code-keyword">is</span> ReentrancyGuard, Ownable {
    <span class="code-keyword">using</span> WadRayMath <span class="code-keyword">for</span> uint256;
    
    <span class="code-comment">// Reserve data structure</span>
    <span class="code-keyword">struct</span> ReserveData {
        <span class="code-keyword">address</span> aTokenAddress;
        <span class="code-keyword">address</span> variableDebtTokenAddress;
        <span class="code-keyword">address</span> interestRateStrategyAddress;
        uint256 liquidityIndex;
        uint256 variableBorrowIndex;
        uint256 currentLiquidityRate;
        uint256 currentVariableBorrowRate;
        uint40 lastUpdateTimestamp;
        <span class="code-keyword">bool</span> isActive;
        <span class="code-keyword">bool</span> isFrozen;
        uint128 id;
    }
    
    <span class="code-comment">// Flash loan protection</span>
    <span class="code-keyword">mapping</span>(<span class="code-keyword">address</span> => uint256) <span class="code-keyword">private</span> _flashLoanTimestamps;
    uint256 <span class="code-keyword">private</span> constant FLASH_LOAN_COOLDOWN = 1 hours;
    uint256 <span class="code-keyword">private</span> constant MAX_FLASH_LOAN_AMOUNT = 10000 ether;
    
    <span class="code-comment">// Core lending function with flash loan protection</span>
    <span class="code-function">function</span> flashLoan(
        <span class="code-keyword">address</span> receiverAddress,
        <span class="code-keyword">address</span>[] calldata assets,
        uint256[] calldata amounts,
        bytes calldata params
    ) <span class="code-keyword">external</span> nonReentrant {
        <span class="code-comment">// Flash loan protection checks</span>
        <span class="code-keyword">require</span>(
            block.timestamp >= _flashLoanTimestamps[msg.sender] + FLASH_LOAN_COOLDOWN,
            <span class="code-string">"Flash loan cooldown active"</span>
        );
        
        <span class="code-keyword">require</span>(
            amounts.length <= 5,
            <span class="code-string">"Max 5 assets per flash loan"</span>
        );
        
        <span class="code-keyword">for</span> (uint256 i = 0; i < amounts.length; i++) {
            <span class="code-keyword">require</span>(
                amounts[i] <= MAX_FLASH_LOAN_AMOUNT,
                <span class="code-string">"Exceeds max flash loan amount"</span>
            );
        }
        
        <span class="code-comment">// Execute flash loan logic</span>
        _executeFlashLoan(receiverAddress, assets, amounts, params);
        
        <span class="code-comment">// Update flash loan timestamp</span>
        _flashLoanTimestamps[msg.sender] = block.timestamp;
        
        <span class="code-keyword">emit</span> FlashLoanExecuted(receiverAddress, assets, amounts);
    }
    
    <span class="code-comment">// Interest rate calculation with risk-adjusted rates</span>
    <span class="code-function">function</span> calculateInterestRates(
        <span class="code-keyword">address</span> reserve,
        uint256 availableLiquidity,
        uint256 totalStableDebt,
        uint256 totalVariableDebt,
        uint256 reserveFactor
    ) <span class="code-keyword">public</span> <span class="code-keyword">view</span> <span class="code-keyword">returns</span> (
        uint256 liquidityRate,
        uint256 stableBorrowRate,
        uint256 variableBorrowRate
    ) {
        <span class="code-comment">// Dynamic rate calculation based on utilization</span>
        uint256 utilizationRate = totalVariableDebt == 0 ? 0 : 
            totalVariableDebt.wadDiv(availableLiquidity + totalVariableDebt);
        
        <span class="code-keyword">if</span> (utilizationRate > OPTIMAL_UTILIZATION_RATE) {
            uint256 excessUtilizationRateRatio = (utilizationRate - OPTIMAL_UTILIZATION_RATE)
                .wadDiv(MAX_EXCESS_UTILIZATION_RATE);
            
            variableBorrowRate = BASE_VARIABLE_BORROW_RATE +
                (excessUtilizationRateRatio.wadMul(SLOPE_RATE_ABOVE_OPTIMAL));
        } <span class="code-keyword">else</span> {
            variableBorrowRate = BASE_VARIABLE_BORROW_RATE +
                (utilizationRate.wadDiv(OPTIMAL_UTILIZATION_RATE)
                    .wadMul(SLOPE_RATE_BELOW_OPTIMAL));
        }
        
        liquidityRate = variableBorrowRate
            .wadMul(utilizationRate)
            .percentMul(PERCENTAGE_FACTOR - reserveFactor);
        
        <span class="code-keyword">return</span> (liquidityRate, stableBorrowRate, variableBorrowRate);
    }
}</span></pre>
                </div>
            </div>

            <!-- Flash Loan Protection System -->
            <div class="flashloan-protection">
                <h2 style="color: #065f46; margin-bottom: 30px;">üõ°Ô∏è Flash Loan Protection System</h2>
                
                <div class="grid-3">
                    <div class="feature-card">
                        <div class="feature-icon">‚è±Ô∏è</div>
                        <h3 class="feature-title">Rate Limiting</h3>
                        <p class="feature-description">
                            Cooldown periods between flash loans from same address
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">üí∞</div>
                        <h3 class="feature-title">Amount Caps</h3>
                        <p class="feature-description">
                            Maximum flash loan amounts per transaction and per address
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">üîç</div>
                        <h3 class="feature-title">Transaction Validation</h3>
                        <p class="feature-description">
                            Real-time validation of flash loan transaction patterns
                        </p>
                    </div>
                </div>
            </div>

            <!-- Security Audit Results -->
            <div class="audit-section">
                <h2 class="section-title" style="color: white;">Security Audit Results</h2>
                
                <div class="audit-grid">
                    <div class="audit-item">
                        <h3 style="color: white; margin-bottom: 15px;">Audit Firms</h3>
                        <p style="color: #cbd5e1;">‚Ä¢ CertiK<br>‚Ä¢ Quantstamp<br>‚Ä¢ Trail of Bits<br>‚Ä¢ ConsenSys Diligence</p>
                    </div>
                    
                    <div class="audit-item">
                        <h3 style="color: white; margin-bottom: 15px;">Findings Summary</h3>
                        <p style="color: #cbd5e1;">‚Ä¢ Critical: 0<br>‚Ä¢ High: 2 (Fixed)<br>‚Ä¢ Medium: 5 (Fixed)<br>‚Ä¢ Low: 8 (Fixed)</p>
                    </div>
                    
                    <div class="audit-item">
                        <h3 style="color: white; margin-bottom: 15px;">Security Score</h3>
                        <div style="font-size: 3rem; font-weight: 800; color: #60a5fa; margin: 15px 0;">9.7/10</div>
                        <p style="color: #cbd5e1;">Industry-leading security rating</p>
                    </div>
                </div>
            </div>

            <!-- Deployment & Metrics -->
            <div class="section">
                <h2 class="section-title">Deployment & Performance Metrics</h2>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value">$8.5M</div>
                        <div class="metric-label">Total Value Locked</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value">99.9%</div>
                        <div class="metric-label">Uptime</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value">45K+</div>
                        <div class="metric-label">Transactions</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value">15+</div>
                        <div class="metric-label">Collateral Assets</div>
                    </div>
                </div>
                
                <div class="deployment-details">
                    <h3 style="color: #0369a1; margin-bottom: 20px;">Deployment Networks</h3>
                    <div style="margin-bottom: 20px;">
                        <span class="network-tag">üè¶ Ethereum Mainnet</span>
                        <span class="network-tag">üî∑ Polygon</span>
                        <span class="network-tag">üü° BSC</span>
                        <span class="network-tag">‚ö° Arbitrum</span>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Network</th>
                                    <th>Contract Address</th>
                                    <th>TVL</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Ethereum</td>
                                    <td>0x89205A3A3b2A69De6Dbf7f01ED13B2108B2c43e7</td>
                                    <td>$5.2M</td>
                                    <td><span style="color: #16a34a;">‚óè Live</span></td>
                                </tr>
                                <tr>
                                    <td>Polygon</td>
                                    <td>0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0</td>
                                    <td>$2.1M</td>
                                    <td><span style="color: #16a34a;">‚óè Live</span></td>
                                </tr>
                                <tr>
                                    <td>BSC</td>
                                    <td>0x10ED43C718714eb63d5aA57B78B54704E256024E</td>
                                    <td>$800K</td>
                                    <td><span style="color: #16a34a;">‚óè Live</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Risk Management -->
            <div class="section">
                <h2 class="section-title">Risk Management Framework</h2>
                
                <div class="risk-matrix">
                    <div class="risk-item">
                        <div class="risk-level risk-mitigated">Market Risk</div>
                        <div style="font-size: 0.9rem; color: #64748b;">Dynamic collateral ratios</div>
                    </div>
                    
                    <div class="risk-item">
                        <div class="risk-level risk-mitigated">Liquidity Risk</div>
                        <div style="font-size: 0.9rem; color: #64748b;">Reserve factors & buffers</div>
                    </div>
                    
                    <div class="risk-item">
                        <div class="risk-level risk-mitigated">Smart Contract Risk</div>
                        <div style="font-size: 0.9rem; color: #64748b;">Multiple audits & formal verification</div>
                    </div>
                    
                    <div class="risk-item">
                        <div class="risk-level risk-partial">Oracle Risk</div>
                        <div style="font-size: 0.9rem; color: #64748b;">Multiple oracle fallbacks</div>
                    </div>
                </div>
            </div>

            <!-- Technology Stack -->
            <div class="section">
                <h2 class="section-title">Technology Stack</h2>
                
                <div class="comparison-table">
                    <div class="comparison-item">
                        <div class="comparison-label">Smart Contracts</div>
                        <div class="comparison-status">
                            <span class="status-good">Solidity 0.8.19</span>
                            <span class="status-good">OpenZeppelin</span>
                            <span class="status-good">Hardhat</span>
                        </div>
                    </div>
                    
                    <div class="comparison-item">
                        <div class="comparison-label">Oracles</div>
                        <div class="comparison-status">
                            <span class="status-good">Chainlink</span>
                            <span class="status-good">Band Protocol</span>
                            <span class="status-good">Tellor</span>
                        </div>
                    </div>
                    
                    <div class="comparison-item">
                        <div class="comparison-label">Testing</div>
                        <div class="comparison-status">
                            <span class="status-good">Foundry</span>
                            <span class="status-good">Waffle</span>
                            <span class="status-good">Echidna</span>
                        </div>
                    </div>
                    
                    <div class="comparison-item">
                        <div class="comparison-label">Security Tools</div>
                        <div class="comparison-status">
                            <span class="status-good">Slither</span>
                            <span class="status-good">Mythril</span>
                            <span class="status-good">Certora</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Future Roadmap -->
            <div class="section">
                <h2 class="section-title">Future Roadmap</h2>
                
                <div class="feature-card" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px;">
                        <div>
                            <h3 style="color: #0369a1; margin-bottom: 20px;">Q1 2024</h3>
                            <ul style="color: #475569; line-height: 1.8;">
                                <li>Cross-chain lending implementation</li>
                                <li>NFT collateral support</li>
                                <li>Improved liquidation mechanisms</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h3 style="color: #0369a1; margin-bottom: 20px;">Q2 2024</h3>
                            <ul style="color: #475569; line-height: 1.8;">
                                <li>Layer 2 scaling solutions</li>
                                <li>Advanced risk scoring</li>
                                <li>DAO governance integration</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Disclaimer -->
            <div style="background: #fef3c7; padding: 30px; border-radius: 12px; margin-top: 60px; border: 2px solid #fcd34d;">
                <h3 style="color: #92400e; margin-bottom: 15px;">‚ö†Ô∏è Important Disclaimer</h3>
                <p style="color: #92400e; line-height: 1.7;">
                    This document is for informational purposes only. The SecureDeFi Lending Protocol involves significant risks 
                    including but not limited to smart contract vulnerabilities, market volatility, and regulatory changes. 
                    Users should conduct their own research and consult with financial advisors before participating.
                </p>
            </div>

            <!-- Contact Information -->
            <div style="text-align: center; padding: 60px 0; border-top: 1px solid #e2e8f0; margin-top: 60px;">
                <h3 style="color: #1e293b; margin-bottom: 20px;">Emmanuel Olatoye</h3>
                <p style="color: #64748b; margin-bottom: 10px;">Blockchain Developer & Smart Contracts Auditor</p>
                <p style="color: #64748b; margin-bottom: 30px;">Specializing in DeFi Security & Protocol Development</p>
                
                <div style="display: flex; justify-content: center; gap: 20px; margin-top: 30px;">
                    <a href="mailto:hello@emmanuelolatoye.dev" style="color: #3b82f6; text-decoration: none;">hello@emmanuelolatoye.dev</a>
                    <span style="color: #cbd5e1;">|</span>
                    <a href="https://github.com/emmanuelolatoye" style="color: #3b82f6; text-decoration: none;">GitHub</a>
                    <span style="color: #cbd5e1;">|</span>
                    <a href="https://twitter.com/eo_blockchain" style="color: #3b82f6; text-decoration: none;">Twitter</a>
                </div>
                
                <p style="margin-top: 40px; color: #94a3b8; font-size: 0.9rem;">
                    Document ID: DEFI-LENDING-2023-11-001 | Hash: 0x8f3c9a...d7e2b5
                </p>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="generatePDF()">
                üìÑ Download PDF
            </button>
            <button class="btn btn-secondary" onclick="window.print()">
                üñ®Ô∏è Print Document
            </button>
            <a href="index.html" class="btn btn-secondary">
                ‚Üê Back to Portfolio
            </a>
        </div>
    </div>

    <script>
        // Function to generate PDF
        function generatePDF() {
            const element = document.getElementById('pdf-content');
            const buttons = document.querySelector('.action-buttons');
            
            // Hide buttons before capturing
            buttons.style.display = 'none';
            
            // Add watermark for PDF
            const watermark = document.createElement('div');
            watermark.style.position = 'absolute';
            watermark.style.top = '50%';
            watermark.style.left = '50%';
            watermark.style.transform = 'translate(-50%, -50%) rotate(-45deg)';
            watermark.style.fontSize = '120px';
            watermark.style.color = 'rgba(59, 130, 246, 0.1)';
            watermark.style.zIndex = '1000';
            watermark.style.pointerEvents = 'none';
            watermark.style.fontWeight = '900';
            watermark.textContent = 'SECURE DEFI';
            element.appendChild(watermark);
            
            html2canvas(element, {
                scale: 2,
                useCORS: true,
                logging: false,
                windowWidth: element.scrollWidth,
                windowHeight: element.scrollHeight,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jspdf.jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4',
                    compress: true
                });

                const imgWidth = 190;
                const pageHeight = 287;
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 10;

                // Add PDF header
                pdf.setFontSize(28);
                pdf.setTextColor(59, 130, 246);
                pdf.text('SecureDeFi Lending Protocol', 105, 20, null, null, 'center');
                
                pdf.setFontSize(12);
                pdf.setTextColor(100, 116, 139);
                pdf.text('Technical Documentation & Security Audit Report', 105, 28, null, null, 'center');
                pdf.text('Confidential - For Professional Review Only', 105, 34, null, null, 'center');

                pdf.addImage(imgData, 'PNG', 10, 45, imgWidth, imgHeight);
                heightLeft -= (pageHeight - 45);

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                pdf.save('SecureDeFi-Lending-Protocol-Documentation.pdf');
                
                // Clean up
                element.removeChild(watermark);
                buttons.style.display = 'flex';
            });
        }

        // Add Font Awesome icons
        window.addEventListener('load', function() {
            const faLink = document.createElement('link');
            faLink.rel = 'stylesheet';
            faLink.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
            document.head.appendChild(faLink);
            
            // Add Inter font
            const interFont = document.createElement('link');
            interFont.rel = 'stylesheet';
            interFont.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap';
            document.head.appendChild(interFont);
            
            // Add Fira Code font
            const firaCode = document.createElement('link');
            firaCode.rel = 'stylesheet';
            firaCode.href = 'https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600&display=swap';
            document.head.appendChild(firaCode);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                e.preventDefault();
                generatePDF();
            }
            
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                generatePDF();
            }
        });
    </script>
</body>
</html>